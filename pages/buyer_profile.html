<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css">
    <title> Buyer Profile </title>

    <link rel="stylesheet" href="../assets/css/style.css">
    <link rel="stylesheet" href="../assets/css/buyer_profile.css">
    <link rel="stylesheet" href="../assets/css/header_footer.css">
    <script src="../assets/js/main.js"></script>
    <link rel="icon" href="../assets/images/cattles/logo1.png" type="image/x-icon">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=PT+Serif:ital,wght@0,400;0,700;1,700&display=swap" rel="stylesheet">
</head>

<body>

    <main>

        <div class = "form_container divspace">

            <form>

                <!-- left section -->

                <div class = "left_section divspace">

                    <div class = "profile_img_container">
                        <img class = "profile_img" src = "../assets/images/profile_logo.png" alt = "profile_img">
                        <input type = "url" id = "image">
                    </div>

                    <div class = "links_container">
                        <div class = "icon_container1"> <i class = "fa-solid fa-paw" id = "icon"></i> </div>
                        <h2> <a href = "cattle/seller_cattlelist.html"> Cattle List </a> </h2>
                    </div>

                    <div class = "links_container">
                        <div class = "icon_container1"> <i class = "fa-solid fa-star" id = "icon"></i> </div>
                        <h2> <a href = "cattle/favourites.html"> Favourites </a> </h2>
                    </div>

                    <div class = "links_container">
                        <div class = "icon_container1"> <i class = "fa-solid fa-right-from-bracket" id = "icon"></i> </div>
                        <h2 class = "links_head" id = "logOut"> Log out </h2>
                    </div>

                    <div class = "links_container">
                        <div class="icon_container2"> <i class="fa-solid fa-trash" id = "icon"></i> </div>
                        <h2 class = "links_head" id = "delete">Delete Account</h2>
                    </div>

                </div>

                 <!-- right section -->

                <div class = "right_section divspace">

                    <div class = "user_details divspace">
                        <h1 class = "head"> Profile </h1>
                        <div class = "divspace divspace1">
                            <div class = "label_container"> <label> Name </label> </div>
                            <div class = "colon_container"> : </div>
                            <div class = "input_container"> <input required type = "text" id = "name" readonly></div>
                        </div>

                        <div class = "divspace divspace1">
                            <div class = "label_container"><label> Phone.No </label></div>
                            <div class = "colon_container"> : </div>
                            <div class = "input_container"> <input required type = "tel" maxlength = "10" id = "phone_no" disabled> </div>
                        </div>

                        <div class = "divspace divspace1">
                            <div class = "label_container"><label> Address </label></div>
                            <div class = "colon_container"> : </div>
                            <div class = "input_container"> <textarea id = "address" readonly></textarea> </div>
                        </div>

                        <div class = "divspace divspace1">
                            <div class = "label_container"><label> Pincode </label></div>
                            <div class = "colon_container"> : </div>
                            <div class = "input_container"> <input required type = "text" id = "pincode" oninput = "this.value = this.value.replace(/[^0-9]/g,'')" minlength = "6" maxlength = "6" readonly> </div>
                        </div>

                        <div class = "btn_container divspace">
                            <div class = "divspace"><button class = "edit_btn" type = "submit" id = "editButton"> Edit </button></div>
                            <div class = "divspace"><button type = "submit" id = "save"> Save </button></div>
                        </div>
                    </div>

                </div>

            </form>

        </div>

    </main>

    <script src = "../assets/js/header.js"></script>
    <script src = "../assets/js/footer.js"></script>

    <script>
        let phone_id1 = JSON.parse(localStorage.getItem('phone_no_id'));
        let userData = JSON.parse(localStorage.getItem('userData'));

        function login_data(e) {
            return e.phone_no == phone_id1;
        }

        person_data = userData.find(login_data);
        document.getElementById("name").value = person_data['name'];
        document.getElementById("phone_no").value = person_data["phone_no"];
        document.getElementById("address").value = person_data["address"];
        document.getElementById("pincode").value = person_data['pincode'];

        document.getElementById("editButton").addEventListener("click", enableInput);

        // function for enabling input

        function enableInput(e) {
            e.preventDefault()
            if (confirm("Are you sure you want to edit the details")) {
                document.getElementById("name").removeAttribute("readonly");
                document.getElementById("address").removeAttribute("readonly");
                document.getElementById("pincode").removeAttribute("readonly");
            }
        }

        // function for updating details

        function updateDetails(e) {
            document.getElementById("name").setAttribute("readonly", "true");
            document.getElementById("address").setAttribute("readonly", "true");
            document.getElementById("pincode").setAttribute("readonly", "true");
        }

        document.getElementById("save").addEventListener("click", disableInput);

        // function for disabling input

        function disableInput(e) {
            if (confirm("Are you sure you want to save the details")) {
                person_data["name"] = document.getElementById("name").value;
                person_data["address"] = document.getElementById("address").value;
                person_data["pincode"] = document.getElementById("pincode").value;

                localStorage.setItem("userData", JSON.stringify(userData));

                location.reload();
            }
        }

        // function for deleting account

        function deleteaccount(e) {
            if (confirm("Are you sure you want to delete the account?")) {
                let phone_id = JSON.parse(localStorage.getItem("phone_no_id"));
                let userData = JSON.parse(localStorage.getItem("userData"));

                function login_data(e) {
                    return e.phone_no == phone_id;
                }

                person_data = userData.find(login_data);
                const removedata = userData.indexOf(person_data);

                userData.splice(removedata, 1);
                localStorage.setItem("userData", JSON.stringify(userData));
                localStorage.removeItem("phone_no_id");
                window.location.href = "../index.html";
            }
        }

        const del = document.querySelector("#delete");
        del.addEventListener("click", deleteaccount)

    </script>

</body>

</html>